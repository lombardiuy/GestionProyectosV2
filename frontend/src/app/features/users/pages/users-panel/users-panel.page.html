

<!--USERS PANEL-->

<div  *ngIf="!(userPanelFacade.loading$ | async) else loadingSpinner"  class="w-100 h-100 d-flex flex-column align-items-center justify-content-center">
  <div class="card w-95 h-95">
    <div class="card-header w-100">
      <div class="w-100 d-flex justify-content-between">
         <h5><i class="fa-solid fa-users"></i> Gesti√≥n de Usuarios </h5>
       <button *ngIf="hasPermission('USER_CREATE')" class="btn btn-sm btn-success "  (click)="displayCreateUserModal()">
          <i class="fa-solid fa-user-plus"></i> Crear Usuario
        </button>
      </div>
     
    </div>

    <div class="card-body d-flex flex-column w-100 h-90">

         
                
            <users-list-component *ngIf="hasPermission('USER_VIEW')" class="w-100 h-100"
              
                 [hasPermission]="hasPermission.bind(this)"
                 [profilePicturePath]="userPanelFacade.profilePicturePath" 
                 [userList]="userPanelFacade.userList$ | async" 
                 [timestamp]="userPanelFacade.timestamp$ | async"

                 (editUserEvent)="displayEditUserModal($event)" 
                 (suspensionUserFromListEvent)="displayUserSuspensionModal($event)" >
                   
            </users-list-component>
    </div>


   
  </div>



</div>

<!--USER CREATE MODAL -->

  <div class="modal fade" id="createUserModal" tabindex="-1" aria-hidden="true">
   <user-create-component     *ngIf="  hasPermission('USER_CREATE')" class="w-100 h-100"
   
    [hasPermission]="hasPermission.bind(this)"
    [userCreateForm]="userPanelFacade.form"
    [profilePicturePath]="userPanelFacade.profilePicturePath"
    [profilePictureStatus]="userPanelFacade.profilePictureStatus$ | async "
    [usersList]="userPanelFacade.userList$ | async"
    [userRolesList]="userPanelFacade.userRoleList$ | async"
    [imagePreview] = "userPanelFacade.imagePreview"
    [formMessage] = "userPanelFacade.formMessage$ | async"
    [saving] = "userPanelFacade.saving$ | async"
    [loadingCreateForm] = "userPanelFacade.loading$ | async"
     [timestamp]="userPanelFacade.timestamp$ | async"
 
    
    (suspensionUserFromPanelEvent)="displayUserSuspensionModal($event)"
    (setProfilePictureEvent)="userPanelFacade.setProfilePicture($event)"
    (saveUserEvent)="saveUserAction()"

    
     
   


   ></user-create-component>


  </div>



<!--USER PASSWORD RESET MODAL -->

<div class="modal fade" id="userPasswordResetModal" tabindex="-1" aria-hidden="true">
   <user-password-reset-component  #userPasswordResetComponent    *ngIf="hasPermission('USER_PASSWORD_RESET')" class="w-100 h-100"
       [hasPermission]="hasPermission.bind(this)"
      [username]="userPanelFacade.form.get('username')?.value" 
         [formMessage] = "userPanelFacade.formMessage$ | async"
      (resetPasswordEvent)="userPasswordResetAction()" 
   

></user-password-reset-component>
</div>

  


<!--USER SUSPENSION MODAL -->

<div class="modal fade" id="userSuspensionModal" tabindex="-1" aria-hidden="true">

<user-suspension-component  #userSuspensionComponent    *ngIf="hasPermission('USER_SUSPENSION')" class="w-100 h-100"
     [hasPermission]="hasPermission.bind(this)"
      [username]="userPanelFacade.form.get('username')?.value" 
      [suspend] = "userPanelFacade.suspend"
      [saving] = "userPanelFacade.saving$ | async"
      [suspensionOrigin] = "userPanelFacade.suspensionOrigin"
      [formMessage] = "userPanelFacade.formMessage$ | async"
      (suspensionUserEvent)="userSuspensionAction($event)">
    
</user-suspension-component>

</div>





<ng-template  #loadingSpinner>
  <loading-spinner class="w-100 h-100"></loading-spinner>
</ng-template>
